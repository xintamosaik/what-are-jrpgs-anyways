<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JRPGMAKER</title>
    <link rel="stylesheet" href="/style.css">
    <script>
        async function askForFilesAndFoldersInUploads() {
            try {
                const response = await fetch("/list_uploads");
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return await response.json();
            } catch (error) {
                console.error("Error fetching files and folders:", error);
            }
        }

        const extensionEmokis = {
            "png": "🖼️",
            "jpg": "🖼️",
            "jpeg": "🖼️",
            "gif": "🎨",
            "mp3": "🎵",
            "wav": "🎵",
            "ogg": "🎵",
            "txt": "📄",
            "json": "📄",
            "html": "🌐",
            "folder": "📁",
            // Add more extensions and their emojis as needed
        };
        function refreshUploads(event) {
            event.preventDefault();
            askForFilesAndFoldersInUploads().then(data => {
                const uploadsDiv = document.getElementById("uploadList");
                uploadsDiv.innerHTML = ""; // Clear previous content

                const folders = data.folders || [];
                const files = data.files || [];

                folders.forEach(folder => {
                    const folderElement = document.createElement("button");
                    folderElement.textContent = `${extensionEmokis["folder"]} ${folder}`;
             

                    uploadsDiv.appendChild(folderElement);
                });

                files.forEach(file => {
                    const fileElement = document.createElement("button");
                    const extension = file.split('.').pop().toLowerCase();
                    if (extensionEmokis[extension]) {
                        fileElement.textContent = `${extensionEmokis[extension]} ${file}`;
                    } else {
                        fileElement.textContent = `📄 ${file}`; // Default emoji for unknown extensions
                    }
                    
                    uploadsDiv.appendChild(fileElement);
                });
            });
        }
        /**
         * Asks the backend for an image file.
         * @param {string} filename - The name of the image file to request.
         */
        async function askForImage(filename) {
            if (!filename) {
                console.error("Filename is required to request an image.");
                return;
            }
            // uploads/1_Interiors/48x48/Room_Builder_48x48.png
            try {
                const response = await fetch(`/uploads/${filename}`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                return await response.blob();
            } catch (error) {
                console.error("Error fetching image:", error);
            }
        }


    </script>
</head>

<body>
    <main id="ui">
        <div id="uploads">


            <h1>Uploads</h1>
            <button type="button" onclick="refreshUploads(event)" title="Refresh uploads list"
                aria-label="Refresh uploads list">
                root
            </button>
            <div id="uploadList"></div>
        </div>
    </main>

</body>

</html>